!function(){"use strict";!function(){function t(t,a,n){return(n=Math.max(0,Math.min(1,(n-t)/(a-t))))*n*(3-2*n)}function a(t,a,n,s,o){const e=Math.abs(t)-n+o,h=Math.abs(a)-s+o;return Math.min(Math.max(e,h),0)+function(t,a){return Math.sqrt(t*t+a*a)}(Math.max(e,0),Math.max(h,0))-o}function n(t,a){return{x:t,y:a}}function s(t,a){const n=43758.5453*Math.sin(12.9898*t+78.233*a);return 2*(n-Math.floor(n))-1}function o(t,a,n=4){let o=0,e=.5,h=1;for(let r=0;r<n;r++)o+=e*s(t*h,a*h),e*=.5,h*=2;return o}const e={liquidGlass:s=>{const o=s.x-.5,e=s.y-.5,h=t(.8,0,a(o,e,.3,.2,.6)-.15),r=t(0,1,h);return n(o*r+.5,e*r+.5)},flowingLiquid:s=>{const o=s.x-.5,e=s.y-.5,h=t(.8,0,a(o,e,.3,.2,1)-.15),r=t(0,1,h);return n(o*r+.5,e*r+.5)},transparentIce:e=>{const h=e.x-.5,r=e.y-.5,i=.05*o(8*e.x,8*e.y,3),M=.02*s(20*e.x,20*e.y),c=a(h,r,.35,.25,.3),u=t(.5,-.2,c),f=h+(i+M+Math.sin(15*e.x+10*i)*Math.cos(12*e.y)*.03)*u,x=r+(.8*i+M)*u,m=.1*t(0,.1,c);return n(f*(1-m)+.5,x*(1-m)+.5)},unevenGlass:e=>{const h=e.x-.5,r=e.y-.5,i=.08*o(3*e.x,3*e.y,2),M=.04*s(6*e.x+i,6*e.y),c=t(.6,-.1,a(h+.3*i,r+.3*i,.32,.22,.4)),u=Math.sin(8*e.x+5*i)*Math.sin(8*e.y)*.02,f=c*(1+.5*M);return n(h+(i+u)*f+.5,r+(.9*i+M+.7*u)*f+.5)},mosaicGlass:o=>{const e=o.x-.5,h=o.y-.5,r=.05,i=Math.floor(o.x/r),M=Math.floor(o.y/r),c=43758.5453*Math.sin(12.9898*i+78.233*M),u=c-Math.floor(c),f=u*Math.PI*2,x=.03*Math.cos(f),m=.03*Math.sin(f),l=t(.4,-.1,a(e,h,.35,.25,.05)),y=o.x%r/r,d=o.y%r/r,g=.1,b=y<g||y>.9||d<g||d>.9,p=.02*s(3.7*i,3.7*M);let q,w;if(b)q=.2*p,w=.2*p;else{const t=1+.04*(u-.5);q=(x+p)*t,w=(m+p)*t}return n(e+q*l+.5,h+w*l+.5)}};self.onmessage=t=>{const{width:a,height:n,effect:s,mousePosition:o,time:h}=t.data,r=a,i=n;let M=0;const c=[];for(let m=0;m<i;m++)for(let t=0;t<r;t++){const a={x:t/r,y:m/i},n=e[s](a,o,h),u=n.x*r-t,f=n.y*i-m;M=Math.max(M,Math.abs(u),Math.abs(f)),c.push(u,f)}M=M>0?Math.max(M,1):1;const u=new ImageData(r,i),f=u.data;let x=0;for(let e=0;e<i;e++)for(let t=0;t<r;t++){const a=c[x++],n=c[x++],s=Math.min(t,e,r-t-1,i-e-1),o=Math.min(1,s/2),h=a*o/M+.5,u=n*o/M+.5,m=4*(e*r+t);f[m]=Math.max(0,Math.min(255,255*h)),f[m+1]=Math.max(0,Math.min(255,255*u)),f[m+2]=Math.max(0,Math.min(255,255*u)),f[m+3]=255}self.postMessage({imageData:u},[u.data.buffer])}}()}();
